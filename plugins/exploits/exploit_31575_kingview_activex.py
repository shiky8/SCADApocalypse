import requests
from utils.logger import setup_logger
logger = setup_logger()

def exploit(target: str, port: int = 80):
    """
    KingScada kxClientDownload.ocx – Andrea Micalizzi / juan vazquez
    """
    url = f"http://{target}:{port}/download/kxClientDownload.ocx"
    try:
        r = requests.get(url, timeout=5)
        if b"MZ" in r.content:
            logger.info("[+] KingScada ActiveX downloaded – inspect for overflow")
            return True
    except Exception as e:
        logger.error(f"KingScada ActiveX error: {e}")
    return False