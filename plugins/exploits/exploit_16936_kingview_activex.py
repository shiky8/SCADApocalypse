import requests
from utils.logger import setup_logger
logger = setup_logger()

def exploit(target: str, port: int = 80):
    """
    KingView 6.5.3 ActiveX – Carlos Mario Penagos Hollmann
    """
    url = f"http://{target}:{port}/download/KingView.ocx"
    try:
        r = requests.get(url, timeout=5)
        if r.status_code == 200 and b"MZ" in r.content:
            logger.info("[+] KingView ActiveX downloaded – inspect for overflow")
            return True
    except Exception as e:
        logger.error(f"KingView ActiveX error: {e}")
    return False